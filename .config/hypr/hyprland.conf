# ╔═══════════════════════════════════════════════════════════════════════════╗
# ║                         HYPRLAND CONFIGURATION                            ║
# ╚═══════════════════════════════════════════════════════════════════════════╝

# ┌───────────────────────────────────────────────────────────────────────────┐
# │                              VARIABLES                                    │
# └───────────────────────────────────────────────────────────────────────────┘

$mainMod = Super
$terminal = kitty
$editor = zed
$explorer = dolphin
$browser = firefox

# ┌───────────────────────────────────────────────────────────────────────────┐
# │                              MONITORS                                     │
# └───────────────────────────────────────────────────────────────────────────┘

monitor = ,preferred,auto,1


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                               INPUT                                       │
# └───────────────────────────────────────────────────────────────────────────┘

input {
    kb_layout = us,es
    repeat_rate = 40
    repeat_delay = 250
    follow_mouse = 1
    sensitivity = 0
    accel_profile = flat
    scroll_method = 2fg
    numlock_by_default = true

    touchpad {
        natural_scroll = yes
        scroll_factor = 0.5
        middle_button_emulation = true
        clickfinger_behavior = true
        tap-to-click = true
        tap-and-drag = true
    }
}

gestures {
    # workspace_swipe = true
    # workspace_swipe_fingers = 3
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                             GENERAL                                       │
# └───────────────────────────────────────────────────────────────────────────┘

general {
    gaps_in = 5
    gaps_out = 10
    border_size = 2
    col.active_border = rgba(33ccffee) rgba(00ff99ee) 45deg
    col.inactive_border = rgba(595959aa)
    layout = dwindle
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                            DECORATION                                     │
# └───────────────────────────────────────────────────────────────────────────┘

decoration {
    rounding = 10

    blur {
        enabled = true
        size = 3
        passes = 1
    }

    shadow {
        enabled = true
        range = 4
        render_power = 3
        color = rgba(1a1a1aee)
    }
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                            ANIMATIONS                                     │
# └───────────────────────────────────────────────────────────────────────────┘

animations {
    enabled = yes
    bezier = liner, 1, 1, 1, 1
    animation = workspaces, 1, 1, liner
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                              LAYOUTS                                      │
# └───────────────────────────────────────────────────────────────────────────┘

dwindle {
    pseudotile = yes
    preserve_split = yes
}

master {
    new_status = master
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                               MISC                                        │
# └───────────────────────────────────────────────────────────────────────────┘

misc {
    enable_anr_dialog = false
    force_default_wallpaper = 0
}


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                            AUTOSTART                                      │
# └───────────────────────────────────────────────────────────────────────────┘

exec-once = libinput-gestures
exec-once = [workspace 1 silent] kitty --title kitty_tmux -e tmux
exec-once = [workspace 2 silent] thunderbird
exec-once = [workspace 3 silent] firefox
exec-once = [workspace 4 silent] slack
exec-once = [workspace 5 silent] discord
exec-once = [workspace 7 silent] torbrowser-launcher
exec-once = [workspace 10 silent] protonmail-bridge
exec-once = [workspace 12 silent] psst-gui
exec-once = [workspace 13 silent] kitty --title kitty_top -e top


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                          WINDOW RULES                                     │
# └───────────────────────────────────────────────────────────────────────────┘

# Workspace assignments
windowrule = workspace 1, match:title ^(kitty_tmux)$
windowrule = workspace 2, match:class ^(thunderbird)$
windowrule = workspace 3, match:class ^(firefox)$
windowrule = workspace 4, match:class ^(Slack)$
windowrule = workspace 5, match:class ^(discord)$
windowrule = workspace 6, match:initial_title ^(Huddle)$
windowrule = workspace 6, match:initial_title ^(Meeting)$
windowrule = workspace 7, match:class ^(Tor Browser)$
windowrule = workspace 10, match:class ^(proton-bridge)$
windowrule = workspace 12, match:class ^(psst-gui)$
windowrule = workspace 13, match:title ^(kitty_top)$

# Opacity rules
windowrule = opacity 0.90 override 0.90 override 1, match:class ^(firefox)$
windowrule = opacity 0.90 override 0.90 override 1, match:class ^(Brave-browser)$
windowrule = opacity 0.80 override 0.80 override 1, match:class ^(code-oss)$
windowrule = opacity 0.80 override 0.80 override 1, match:class ^([Cc]ode)$
windowrule = opacity 0.80 override 0.80 override 1, match:class ^(code-url-handler)$
windowrule = opacity 0.80 override 0.60 override 1, match:class ^(kitty)$
windowrule = opacity 0.80 override 0.80 override 1, match:class ^(org.kde.dolphin)$
windowrule = opacity 0.80 override 0.80 override 1, match:class ^(org.kde.ark)$
windowrule = opacity 0.80 override 0.80 override 1, match:class ^(nwg-look)$
windowrule = opacity 0.80 override 0.80 override 1, match:class ^(qt5ct)$
windowrule = opacity 0.80 override 0.80 override 1, match:class ^(qt6ct)$
windowrule = opacity 0.80 override 0.80 override 1, match:class ^(kvantummanager)$
windowrule = opacity 0.80 override 0.70 override 1, match:class ^(org.pulseaudio.pavucontrol)$
windowrule = opacity 0.80 override 0.70 override 1, match:class ^(blueman-manager)$
windowrule = opacity 0.80 override 0.70 override 1, match:class ^(nm-applet)$
windowrule = opacity 0.80 override 0.70 override 1, match:class ^(nm-connection-editor)$
windowrule = opacity 0.70 override 0.70 override 1, match:class ^([Ss]team)$
windowrule = opacity 0.70 override 0.70 override 1, match:class ^(steamwebhelper)$
windowrule = opacity 0.70 override 0.70 override 1, match:class ^([Ss]potify)$
windowrule = opacity 0.80 override 0.80, match:class ^(discord)$
windowrule = opacity 0.80 override 0.80, match:class ^(vesktop)$

# Float rules
windowrule = float on, match:class ^(org.kde.ark)$
windowrule = float on, match:class ^(nwg-look)$
windowrule = float on, match:class ^(qt5ct)$
windowrule = float on, match:class ^(qt6ct)$
windowrule = float on, match:class ^(kvantummanager)$
windowrule = float on, match:class ^(org.pulseaudio.pavucontrol)$
windowrule = float on, match:class ^(blueman-manager)$
windowrule = float on, match:class ^(nm-applet)$
windowrule = float on, match:class ^(nm-connection-editor)$
windowrule = float on, match:class ^(org.kde.polkit-kde-authentication-agent-1)$
windowrule = float on, match:class ^(org.kde.dolphin)$, match:title ^(Progress Dialog — Dolphin)$
windowrule = float on, match:class ^(org.kde.dolphin)$, match:title ^(Copying — Dolphin)$
windowrule = float on, match:title ^(About Mozilla Firefox)$
windowrule = float on, match:class ^(firefox)$, match:title ^(Picture-in-Picture)$
windowrule = float on, match:class ^(firefox)$, match:title ^(Library)$
windowrule = float on, match:class ^(kitty)$, match:title ^(top)$
windowrule = float on, match:class ^(kitty)$, match:title ^(btop)$
windowrule = float on, match:class ^(kitty)$, match:title ^(htop)$
windowrule = float on, match:class ^(vlc)$
windowrule = float on, match:class ^(eog)$
windowrule = float on, match:class ^(Signal)$
windowrule = float on, match:class ^(xdg-desktop-portal-gtk)$
windowrule = float on, match:initial_title ^(Open File)$
windowrule = float on, match:title ^(Choose Files)$
windowrule = float on, match:title ^(Save As)$
windowrule = float on, match:title ^(Confirm to replace files)$
windowrule = float on, match:title ^(File Operation Progress)$


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                           LAYER RULES                                     │
# └───────────────────────────────────────────────────────────────────────────┘

layerrule = blur on, ignore_alpha 0, match:namespace rofi
layerrule = blur on, ignore_alpha 0, match:namespace notifications
layerrule = blur on, ignore_alpha 0, match:namespace swaync-notification-window
layerrule = blur on, ignore_alpha 0, match:namespace swaync-control-center
layerrule = blur on, match:namespace logout_dialog


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                           KEYBINDINGS                                     │
# └───────────────────────────────────────────────────────────────────────────┘

# ─── Core ───────────────────────────────────────────────────────────────────
bind = $mainMod, Return, exec, kitty
bind = $mainMod, Q, killactive
bind = $mainMod, Delete, exit
bind = $mainMod, W, togglefloating
bind = $mainMod, G, togglegroup
bind = $mainMod, F11, fullscreen
bind = $mainMod, J, togglesplit

# ─── Apps ───────────────────────────────────────────────────────────────────
bind = $mainMod, E, exec, $explorer

# ─── Rofi (requires rofi-wayland) ───────────────────────────────────────────
# TODO: Replace HyDE rofi scripts with your own or use rofi directly
bind = $mainMod, D, exec, pkill -x rofi || rofi -show drun
bind = $mainMod, A, exec, pkill -x rofi || rofi -show drun
bind = $mainMod, TAB, exec, pkill -x rofi || rofi -show window
bind = $mainMod, V, exec, pkill -x rofi || cliphist list | rofi -dmenu | cliphist decode | wl-copy

# ─── Screenshots (requires grimblast or similar) ────────────────────────────
# TODO: Replace with grimblast or grim+slurp
bind = $mainMod, P, exec, grimblast copy area
bind = $mainMod Alt, P, exec, grimblast copy output
bind = , Print, exec, grimblast copy screen

# ─── Color picker ───────────────────────────────────────────────────────────
bind = $mainMod Shift, P, exec, hyprpicker -an

# ─── Lock screen (requires swaylock or hyprlock) ────────────────────────────
bind = $mainMod, L, exec, swaylock

# ─── Focus ──────────────────────────────────────────────────────────────────
bind = $mainMod, Left, movefocus, l
bind = $mainMod, Right, movefocus, r
bind = $mainMod, Up, movefocus, u
bind = $mainMod, Down, movefocus, d

# ─── Group navigation ───────────────────────────────────────────────────────
bind = $mainMod Control, H, changegroupactive, b
bind = $mainMod Control, L, changegroupactive, f

# ─── Resize ─────────────────────────────────────────────────────────────────
binde = $mainMod Shift, Right, resizeactive, 30 0
binde = $mainMod Shift, Left, resizeactive, -30 0
binde = $mainMod Shift, Up, resizeactive, 0 -30
binde = $mainMod Shift, Down, resizeactive, 0 30

# ─── Move window ────────────────────────────────────────────────────────────
bind = $mainMod Shift Control, Left, movewindow, l
bind = $mainMod Shift Control, Right, movewindow, r
bind = $mainMod Shift Control, Up, movewindow, u
bind = $mainMod Shift Control, Down, movewindow, d

# ─── Mouse bindings ─────────────────────────────────────────────────────────
bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow
bindm = $mainMod, Z, movewindow
bindm = $mainMod, X, resizewindow

# ─── Audio (requires wpctl or pamixer) ──────────────────────────────────────
bindl = , XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindle = , XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bindle = , XF86AudioRaiseVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%+
bindl = , XF86AudioMicMute, exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle

# ─── Media (requires playerctl) ─────────────────────────────────────────────
bindl = , XF86AudioPlay, exec, playerctl play-pause
bindl = , XF86AudioPause, exec, playerctl play-pause
bindl = , XF86AudioNext, exec, playerctl next
bindl = , XF86AudioPrev, exec, playerctl previous

# ─── Brightness (requires brightnessctl) ────────────────────────────────────
bindle = , XF86MonBrightnessUp, exec, brightnessctl set +5%
bindle = , XF86MonBrightnessDown, exec, brightnessctl set 5%-

# ─── Keyboard layout ────────────────────────────────────────────────────────
bind = $mainMod, K, exec, hyprctl switchxkblayout all next

# ─── Workspaces ─────────────────────────────────────────────────────────────
bind = $mainMod, 1, workspace, 1
bind = $mainMod, 2, workspace, 2
bind = $mainMod, 3, workspace, 3
bind = $mainMod, 4, workspace, 4
bind = $mainMod, 5, workspace, 5
bind = $mainMod, 6, workspace, 6
bind = $mainMod, 7, workspace, 7
bind = $mainMod, 8, workspace, 8
bind = $mainMod, 9, workspace, 9
bind = $mainMod, 0, workspace, 10
bind = $mainMod, N, workspace, 11
bind = $mainMod, M, workspace, 12
bind = $mainMod, B, workspace, 13
bind = $mainMod, C, workspace, 14
bind = $mainMod, O, workspace, 15

# ─── Move to workspace ──────────────────────────────────────────────────────
bind = $mainMod Shift, 1, movetoworkspace, 1
bind = $mainMod Shift, 2, movetoworkspace, 2
bind = $mainMod Shift, 3, movetoworkspace, 3
bind = $mainMod Shift, 4, movetoworkspace, 4
bind = $mainMod Shift, 5, movetoworkspace, 5
bind = $mainMod Shift, 6, movetoworkspace, 6
bind = $mainMod Shift, 7, movetoworkspace, 7
bind = $mainMod Shift, 8, movetoworkspace, 8
bind = $mainMod Shift, 9, movetoworkspace, 9
bind = $mainMod Shift, 0, movetoworkspace, 10
bind = $mainMod Shift, N, movetoworkspace, 11
bind = $mainMod Shift, M, movetoworkspace, 12
bind = $mainMod Shift, B, movetoworkspace, 13
bind = $mainMod Shift, C, movetoworkspace, 14
bind = $mainMod Shift, O, movetoworkspace, 15

# ─── Move to workspace (silent) ─────────────────────────────────────────────
bind = $mainMod Alt, 1, movetoworkspacesilent, 1
bind = $mainMod Alt, 2, movetoworkspacesilent, 2
bind = $mainMod Alt, 3, movetoworkspacesilent, 3
bind = $mainMod Alt, 4, movetoworkspacesilent, 4
bind = $mainMod Alt, 5, movetoworkspacesilent, 5
bind = $mainMod Alt, 6, movetoworkspacesilent, 6
bind = $mainMod Alt, 7, movetoworkspacesilent, 7
bind = $mainMod Alt, 8, movetoworkspacesilent, 8
bind = $mainMod Alt, 9, movetoworkspacesilent, 9
bind = $mainMod Alt, 0, movetoworkspacesilent, 10
bind = $mainMod Alt, N, movetoworkspacesilent, 11
bind = $mainMod Alt, M, movetoworkspacesilent, 12
bind = $mainMod Alt, B, movetoworkspacesilent, 13
bind = $mainMod Alt, C, movetoworkspacesilent, 14
bind = $mainMod Alt, O, movetoworkspacesilent, 15

# ─── Relative workspace navigation ──────────────────────────────────────────
bind = $mainMod Control, Right, workspace, r+1
bind = $mainMod Control, Left, workspace, r-1
bind = $mainMod Control, Down, workspace, empty
bind = $mainMod Control+Alt, Right, movetoworkspace, r+1
bind = $mainMod Control+Alt, Left, movetoworkspace, r-1

# ─── Scratchpad ─────────────────────────────────────────────────────────────
bind = $mainMod Shift, S, movetoworkspace, special
bind = $mainMod Alt, S, movetoworkspacesilent, special
bind = $mainMod, S, togglespecialworkspace

# ─── Mouse workspace scroll ─────────────────────────────────────────────────
bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up, workspace, e-1
